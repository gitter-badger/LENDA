<style>
  label{ font-weight:normal; color:#AAA; }
  .red{color: #CC0000; }
</style>
<!--<pre>{{farmExpenses | json}}</pre>-->
<fieldset>
<legend>Loan Summary</legend>
<!--Analyst/Loan Type/App Date-->
<div class="row">
  <div class="form-group col-md-4">
    <label>Originating Officer:</label>
    <br/>
    <p class="display-field">
      {{loan.analyst.name}}
    </p>
  </div>
  <div class="form-group col-md-4">
    <label>Loan Type</label>
    <br/>
    <p class="display-field">
      {{loan.loan_type}}
      <span ng-if="loan.is_addendum"> - Addendum</span>
    </p>
  </div>
  <div class="form-group col-md-4">
    <label ng-if="!loan.is_addendum">Application Date</label>
    <label ng-if="loan.is_addendum">Addendum Date</label>
    <br/>
    <p class="display-field">
      {{loan.app_date | date:'M/d/yy'}}
    </p>
  </div>
</div>

<!--Interest Rate/Due Date/Status-->
<div class="row">
  <div class="form-group col-md-4">
    <label>Interest Rate</label>
    <br/>
    <table style="width:120px;">
      <tr>
        <td style="width:50%;">ARM:</td>
        <td>{{loan.fins.int_percent_arm | number:1}}%</td>
      </tr>
      <tr ng-if="loan.has_distributor">
        <td>{{loan.distributor}}:</td>
        <td>{{loan.fins.int_percent_dist | number:1}}%</td>
      </tr>
    </table>
  </div>
  <div class="form-group col-md-4">
    <label>Due Date</label>
    <br/>
    <p class="display-field">
      {{loan.due_date | date:'M/d/yy'}}
    </p>
  </div>
  <div class="form-group col-md-4">
    <label>Application Status</label>
    <br/>
    <p class="display-field">
      {{loan.status}}
    </p>
  </div>
</div>

<!--Entity/Applicant/Stakeholders-->
<div class="row">
  <div class="form-group col-md-4">
    <label>Organization Type</label>
    <br/>
    <p class="display-field">
      {{applicant.entity}}
    </p>
  </div>
  <div class="form-group col-md-4">
    <label>Applicant</label>
    <br/>
    <p class="display-field">
      {{applicant.applicant | displayname}}
      <br/>
      {{applicant.address}}
      <br/>
      {{applicant.city}}, {{applicant.state_abr}} {{applicant.zip}}
      <br/>
      {{applicant.phone | phone}}
      <br/>
      {{applicant.email}}
      <br/>
    </p>
  </div>
  <!--<pre>{{corps | json}}</pre>-->
  <div class="form-group col-md-4">
    <div ng-switch="applicant.entity_id">
      <div ng-switch-when="1">
        <label>Corporation</label>
        <br/>
        <p class="display-field" ng-repeat="c in corps">
          {{c.corporation}}
          <br/>
          {{c.president}}, (President)
          <br/>
          {{c.vicepresident}}, (Vice-President)
          <br/>
          {{c.secretarytreasurer}}, (Secretary / Treasurer)
        </p>
      </div>
      <div ng-switch-when="3">
        <label>Joint Venture</label>
        <br/>
        <p class="display-field" ng-repeat="j in joints">
          {{j.partner}}
          <br/>
          {{j.address}}
          <br/>
          {{j.city}}, {{j.state_abr}} {{j.zip}}
          <br/>
          {{j.phone | phone}}
          <br/>
          {{j.email}}
        </p>
      </div>
      <div ng-switch-when="4">
        <label>Partners</label>
        <br/>
        <p class="display-field" ng-repeat="p in partners">
          {{p.partner}}
          <br/>
          {{p.address}}
          <br/>
          {{p.city}}, {{p.state_abr}} {{p.zip}}
          <br/>
          {{p.phone | phone}}
          <br/>
          {{p.email}}
          <br/><br/>
        </p>
      </div>
      <div ng-switch-when="5">
        <label>Spouse</label>
        <br/>
        <p class="display-field">
          {{applicant.spouse | displayname}}
          <br/>
          {{applicant.address}}
          <br/>
          {{applicant.city}}, {{applicant.state_abr}} {{applicant.zip}}
          <br/>
          {{applicant.spouse_phone | phone}}
          <br/>
          {{applicant.spouse_email}}
          <br/>
        </p>
      </div>
    </div>
  </div>
</div>

<!--Income%/Crops-Irrigation-->
<div class="row">
  <div class="form-group col-md-4">
    <label>Income From Farm</label>
    <br/>
    <p class="display-field">
      {{quests.income_percent | number:1}}%
    </p>
  </div>
  <div class="form-group col-md-8">
    <label>Crops / Percent Irrigated</label>
    <br/>
    <p class="display-field">
      {{getCropsPercentIrrigated($stateParams.loanID)}}
    </p>
  </div>
</div>

<!--Income% Explanation-->
<div class="row" ng-if="quests.income_percent < 100">
  <div class="form-group col-md-12">
    <label>Additional Income</label>
    <p>{{quests.income_distribution_details}}</p>
  </div>
</div>

<!--Distributor/Pesticide Number-->
<div class="row" ng-if="loan.has_distributor">
  <div class="form-group col-md-4">
    <label>Participating Distributor</label>
    <br/>
    <p class="display-field">
      {{loan.distributor}}
    </p>
  </div>
  <div class="form-group col-md-4">
    <label>Pesticide Number</label>
    <br/>
    <p class="display-field">
      {{quests.pesticide_number}}
    </p>
  </div>
</div>

<!--LOAN SUMMARY-->
<div ng-repeat="c in comments | filter:{type:'Loan'}">
  <div class="alert alert-default" role="alert">
    <h4><span class="glyphicon glyphicon-pencil" ></span> Loan Summary
    </h4>
    <hr/>
    <p style="font-size:11px;font-weight:bold;"><i>{{c.user}}</i>
      &nbsp;&nbsp;-&nbsp;&nbsp;
      <i>{{c.dtCom | date:'MM/dd/yy'}}</i></p>
    <p>{{c.comment}}</p>
  </div>
</div>

<!--Collateral Conditions-->
  <!--TODO all conditions listed; incomplete is in red-->
<div class="row" style="padding-top: 20px;">
  <div class="form-group col-md-12 text-left">
    <b>Loan/Collateral Conditions</b>
    <div class="row">
      <div class="form-group col-md-6 col-md-offset-1">
        <p class="lg-text" ng-class="{'red': c.status == 'pending'}" ng-repeat="c in loanConditions">{{c.condition}}</p>
      </div>
    </div>
  </div>
</div>

<!--Projected Income-->
<div class="row" style="padding-top: 20px;">
  <div class="form-group col-md-12 text-left">
    <b>Projected Income</b>
  </div>
  <div class="row">
    <div class="col-md-11" style="margin-left:20px;">
      <div ng-include="'angular/views/loans/partials/income_summary_table.html'"></div>
    </div>
  </div>
</div>

<!--USE OF FUNDS ANALYSIS-->
<div class="row" style="padding-top: 20px;">
  <div class="form-group col-md-12 text-left">
    <b>Use of Funds Analysis</b>
  </div>
  <div class="row">
    <div class="col-md-11" style="margin-left:20px;">
      <div ng-include="'angular/views/loans/partials/budget_summary_table.html'"></div>
    </div>
  </div>
</div>

<!--INSURANCE ANALYSIS-->
<div class="row" style="padding-top: 20px;">
  <div class="form-group col-md-12 text-left">
    <b>Crop Insurance Analysis</b>
  </div>
  <div class="row form-group col-md-10 col-md-offset-1" >
    <table class="table" style="width:80%;">
      <tr>
        <td style="width:60%;">ARM<span ng-if="loan.has_distributor"> and {{loan.distributor}} </span>Loan secured by Collateral Conditions</td>
        <td style="width:40%;" colspan="3" class="text-right">
          {{loan.fins.arm_and_dist | flexCurrency:0}}
        </td>
      </tr>
      <tr>
        <td>Applicant's share of crop insurance less premium</td>
        <td colspan="3" class="text-right">
          {{loan.fins.guaranty | flexCurrency:0}}
        </td>
      </tr>
      <tr>
        <td>Crop Insurance coverage in excess of ARM and {{loan.distributor}} Loan</td>
        <td colspan="3" class="text-right">
          {{loan.fins.guaranty - financials.arm_and_dist | flexCurrency:0}}
        </td>
      </tr>
    </table>
  </div>
</div>

<!--BREAK-EVEN ANALYSIS-->
<!-- Need to loop through Selected Crops -->
<div class="row" style="padding-top: 20px;">
  <div class="form-group col-md-12 text-left">
    <b>Break Even Analysis</b>
  </div>
  <div class="row form-group col-md-10 col-md-offset-1" >
    <table class="table" style="width:80%;">
      <tr>
        <td style="width:35%;">Loan payback break-even for ARM<span ng-if="loan.has_distributor"> and {{loan.quests.distributor}}</span>:</td>
        <td style="width:10%;">CORN</td>
        <td class="text-right" style="width:10%;">
          {{loanCrops[0].break_even | number:1}}
        </td>
      </tr>
      <tr>
        <td style="width:35%;">Loan payback break-even for ARM<span ng-if="loan.has_distributor"> and {{loan.quests.distributor}}</span>:</td>
        <td style="width:10%;">SOYBEANS</td>
        <td class="text-right" style="width:10%;">
          {{loanCrops[1].break_even | number:1}}
        </td>
      </tr>
    </table>
  </div>
</div>

<div class="row">
  <div class="col-md-12 text-right">
    <button style="margin-right:10px;" class="btn btn-primary">
      <span class="glyphicon glyphicon-envelope"></span> EMAIL
    </button>
  </div>
</div>
</fieldset>
<!--<pre>{{financials | json}}</pre>-->
<!--<pre>{{loantypes | json}}</pre>-->
