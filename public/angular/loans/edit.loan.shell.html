<style>
    .table>tbody>tr>td{ padding:5px !important;}
    .enabled{ color: #ffff00; }
    .disabled{ color: #999999; }
</style>
<div class="frmFull_Page">
  <div class="row frmBarsm clr-black">
    <div class="col-md-5">
      <h6>{{loan.loan_type}} - {{loan.crop_year}} - {{loan.season_full}}: {{loan.applicant.applicant}} ({{loan.farmer.farmer|displayname}} )</h6>
    </div>
    <div class="col-md-1 text-center">&nbsp;</div>
    <div class="col-md-1 text-center">
      <div style="margin-top: 8px; cursor:pointer;"
           ng-class="{'enabled': XColView, 'disabled': !XColView}"
           ng-show="loan.is_cross_collateralized"
           ng-model="XColView"
           ng-click="XColView = !XColView">
        <span class="glyphicon glyphicon-random"></span>
      </div>
    </div>
    <div class="col-md-1 text-center">
      <div style="margin-top: 8px; cursor:pointer;"
           ng-class="{'enabled': toggleComment, 'disabled': !toggleComment}"
           ng-show="loan.analyst.id === user.id"
           ng-model="toggleComment"
           ng-click="toggleComment = !toggleComment">
        <span class="glyphicon glyphicon-file"></span>
      </div>
    </div>
    <div class="col-md-4 text-right" style="color:white;margin-top:5px;">
      <!-- TODO: DIRECTIVES LIKE PLUNKER-->
    <span ng-if="loan.loan_type_id != 7">
        CF: {{AppFactory.calcCashFlow(loan)|flexCurrency:0}}
        &nbsp;&nbsp;|&nbsp;&nbsp;
    </span>
    <span ng-if="loan.loan_type_id != 3 && loan.loan_type_id != 4">
        RM: {{AppFactory.calcRiskMargin(loan)|flexCurrency:0}}
    </span>
    <span ng-if="loan.loan_type_id == 3 || loan.loan_type_id == 4">
        &nbsp;&nbsp;|&nbsp;&nbsp;
        <sub>adj</sub>RM: {{AppFactory.calcAdjustedRiskMargin(loan)|flexCurrency:0}}
    </span>
    </div>
  </div>

  <div class="row frmBar clr-darkgreen" style="margin-top: -12px;" ng-show="XColView">
    <div class="col-md-12">
      <h5>Cross Collateral View</h5>
    </div>
  </div>

  <div class="row">
    <div class="form-group col-md-12" style="margin-bottom: -20px;">
      <div ng-include="'angular/layout/topbars/loanProgress.html'"></div>
    </div>
  </div>

  <hr style="margin-top: 5px;"/>

  <div class="row" style="display:none;">
    <div class="col-md-12">
      <pre>{{loan|json}}</pre>
    </div>
  </div>

    <div class="row" ng-show="toggleComment">
        <div class="container">
            <div class="col-md-12">
                <div ng-include="'angular/loans/comments/_loan.comment.form.html'"></div>
            </div>
        </div>
    </div>

  <div class="row" ng-show="!toggleComment">
    <div class="col-md-2">
      <div>
        <div ng-if="loan.loan_type_id == 1" ng-include="'angular/layout/sidebars/allIn.html'"></div>
        <div ng-if="loan.loan_type_id == 2" ng-include="'angular/layout/sidebars/agInput.html'"></div>
        <div ng-if="loan.loan_type_id == 3" ng-include="'angular/layout/sidebars/agPro.html'"></div>
        <div ng-if="loan.loan_type_id == 4" ng-include="'angular/layout/sidebars/agProFasttrack.html'"></div>
        <div ng-if="loan.loan_type_id == 5" ng-include="'angular/layout/sidebars/capitalBridge.html'"></div>
        <div ng-if="loan.loan_type_id == 6" ng-include="'angular/layout/sidebars/agVest.html'"></div>
        <div ng-if="loan.loan_type_id == 7" ng-include="'angular/layout/sidebars/grainStorage.html'"></div>
      </div>
    </div>
    <div class="col-md-10">
      <div ui-view>
        <pre>{{loan | json}}</pre>
      </div>
    </div>
  </div>
</div>
<!--<pre>{{loan | json}}</pre>-->